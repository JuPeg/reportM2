{
    "docs": [
        {
            "location": "/", 
            "text": "Metavisitor, a software to detect or identify new viruses from Next Generation Sequencing datasets\n\n\nInternship Report\n\n\n\n\nIntern:\n Juliana Alves Pegoraro\n\n\nInternship supervisor:\n Christophe Antoniewski\n\n\nINSA academic advisor:\n Nicolas Parisot\n\n\nUNESP academic advisor:\n Juliana de Oliveira", 
            "title": "Home"
        }, 
        {
            "location": "/#metavisitor-a-software-to-detect-or-identify-new-viruses-from-next-generation-sequencing-datasets", 
            "text": "Internship Report   Intern:  Juliana Alves Pegoraro  Internship supervisor:  Christophe Antoniewski  INSA academic advisor:  Nicolas Parisot  UNESP academic advisor:  Juliana de Oliveira", 
            "title": "Metavisitor, a software to detect or identify new viruses from Next Generation Sequencing datasets"
        }, 
        {
            "location": "/artbio/", 
            "text": "ARTbio\n\n\nThe \nInstitut de Biologie Paris Seine\n (IBPS) was created in January 2014 in the Jussieu Campus within the \nUniversit\u00e9 Pierre et Marie Curie\n (UPMC). Its main goal is to bring together all the biology researches developed in the campus so it can become the UPMC's biology flagship.\n\n\nIn September 2015, ARTbio, a bioinformatics platform, was created within IBPS. Aiming for \nA\nccessibility, \nR\neproducibility and \nT\nransparency in computational \nbio\nlogy, the team offers support and analyses services for scientists in the UPMC and elsewhere. For doing so, ARTbio works with the Galaxy system, an open source and web-based platform dedicated to scientific and biomedical research. The Galaxy project proposes a user-friendly interface where everyone would be able to run one's own computational data analyses as well as reproduce and share complete analyses. \n\n\nThanks to Galaxy, ARTbio is able to involve biologists in their computational analyses. Besides realizing their computational analyses, other types of services are available, as assisting the experimental and computational analyses and providing advanced training in Galaxy usage. \n\n\nAdditionally, ARTbio provides two Galaxy instances: \nMississippi\n (public) and \nPlastisipi\n (access restricted to UPMC) which are available for autonomous users for free. These instances are maintained by the team that also develops and adapt tools to the Galaxy environment.\n\n\nIn the Galaxy system, tools can be organized on purpose in suites of tools and be arranged in workflows. ARTbio has made publicly available a suite of tools called \nMississipi toolsuite\n for mining mi, si and pi RNA sequencing datasets. Another suite of tools, \nsuite_visitor2\n was recently released followed by a \nBioRxiv preprint\n. These tools are combined within a set of Galaxy workflows to create the Metavisitor package. With Metavisitor, scientists and health professionals are able to detect known viruses and to discover novel viruses from small RNA sequencing datasets.\n\n\nDuring my six months internship at ARTbio, I have been working with the Metavisitor suite. In the pages that follow, I will present my propositions for improving Metavisitor.", 
            "title": "ARTbio"
        }, 
        {
            "location": "/artbio/#artbio", 
            "text": "The  Institut de Biologie Paris Seine  (IBPS) was created in January 2014 in the Jussieu Campus within the  Universit\u00e9 Pierre et Marie Curie  (UPMC). Its main goal is to bring together all the biology researches developed in the campus so it can become the UPMC's biology flagship.  In September 2015, ARTbio, a bioinformatics platform, was created within IBPS. Aiming for  A ccessibility,  R eproducibility and  T ransparency in computational  bio logy, the team offers support and analyses services for scientists in the UPMC and elsewhere. For doing so, ARTbio works with the Galaxy system, an open source and web-based platform dedicated to scientific and biomedical research. The Galaxy project proposes a user-friendly interface where everyone would be able to run one's own computational data analyses as well as reproduce and share complete analyses.   Thanks to Galaxy, ARTbio is able to involve biologists in their computational analyses. Besides realizing their computational analyses, other types of services are available, as assisting the experimental and computational analyses and providing advanced training in Galaxy usage.   Additionally, ARTbio provides two Galaxy instances:  Mississippi  (public) and  Plastisipi  (access restricted to UPMC) which are available for autonomous users for free. These instances are maintained by the team that also develops and adapt tools to the Galaxy environment.  In the Galaxy system, tools can be organized on purpose in suites of tools and be arranged in workflows. ARTbio has made publicly available a suite of tools called  Mississipi toolsuite  for mining mi, si and pi RNA sequencing datasets. Another suite of tools,  suite_visitor2  was recently released followed by a  BioRxiv preprint . These tools are combined within a set of Galaxy workflows to create the Metavisitor package. With Metavisitor, scientists and health professionals are able to detect known viruses and to discover novel viruses from small RNA sequencing datasets.  During my six months internship at ARTbio, I have been working with the Metavisitor suite. In the pages that follow, I will present my propositions for improving Metavisitor.", 
            "title": "ARTbio"
        }, 
        {
            "location": "/introduction/", 
            "text": "Introduction\n\n\nThe next-generation sequencing (NGS) technologies, also known as high-throughput sequencing, have developped very fast in the past few years. Between the most known technologies there are Illumina, Roche 454 and SOLiD. These platforms are able to produce over billions of short read data every day. This huge amount of data at lower costs enables deep sequencing and enlarge the application possibilities. [^EMBL-EBI] These technologies can, for example, aid the study of metagenomics and the understanding of the host-pathogen interactions. [^Gausson]\n\n\nViruses present a high diversity in which concern their genomes. Single or double-stranded, RNA or DNA, linear or circular, as well as different types of replication cycles, intermediates and strategies can hamper viral sequencing and detection. For instance, viruses with no DNA stage can not be detected by DNA sequencing and viruses without poly-A tails are not detected by most mRNA sequencing protocols. [^Kreuze][^Carissimo]\n\n\nAttempting to avoid this issue and knowing that NGS technologies are suitable for small RNA sequencing, Kreuze \net al.\n proposed in 2009 to use vsiRNA as a solution to virus identification. This approach would enable the identification of virus in low concentration as well as new virus with no prior information. [^Kreuze]\n\n\nRNA interference (RNAi) is one of the mechanisms used by plants and invertebrates in gene expression control. Besides silencing endogenous genes, this process is also a potent antiviral pathway. The Dicer enzyme mediates this process by recognising the viral RNA which is then cleaved in smaller RNA duplex called virus-derived small RNA (vsiRNA). [^Sabin] According to previous studies about Dicer's substract, different forms of viral RNA may be a vsiRNA precursor: double-strand RNA (dsRNA) as well as regions in highly structured hairpin in simple-strand RNA (ssRNA) or messenger RNA (mRNA). DNA virus are also directly identified and cleaved by Dicer enzymes. However, ssRNA virus must be transformed in dsRNA before Dicer recognition. [^Aliyari]\n\n\nAccording to Gausson and Saleh, vsiRNA molecules indicate the activation of the antiviral response in the host and its abundance reveals the degree of viral replication and gene expression. [^Gausson] Though vsiRNA molecules have a characterisc length (varying from 21 to 23 nucleotides according to the host), the cleavages distribution in the viral genome remains unclear: some virus are cleaved in limited regions while others are targeted through the whole genome. [^Gausson][^Sabin]\n\n\nMapping these small molecules against a reference viral genome can give informations about the nature and the structure of the viral dsRNA. Moreover, as viral genomes evolve fast, it is important to know and to identify viral variants for biological and medical researches. It can be conveniently done by scaffolding vsiRNA short sequences into a known similar reference sequence. [^Gausson][^Vodovar]\n\n\nIntenting to determine viral variants, Vodovar \net al.\n proposed \nPaparazzi\n, a perl script that aims to reconstitute a virus complete genome from vsiRNA and an initial reference sequence as scaffold thanks to an iterative algorithm. The script was tested with small RNA sequencing data from \nDrosophila melanogaster\n infected with \nNora virus\n. The study showed that the improved sequence had a higher coverage when compared with the initial \nNora virus\n reference genome. [^Vodovar] With the same goal, SearchSmallRNA is a software developed in java that uses a similar approch. [^Andrade] \n\n\nHowever, both SearchSmallRNA and Paparazzi present the same combination of cons. At first, they demand some computer skills from users for installation and execution. Secondly, they require a close enough sequence to serve as reference for guiding the algorithm. This preclude the identification of new or unexpected viruses. Lastly, these programs are not currently available for download.\n\n\nAiming to release a software able to detect and reconstruct viral genomes from NGS datasets without the problems mentioned above, ARTbio developed Metavisitor, a free and open source set of Galaxy tools and workflows. \n\n\n\n\n[^Ikegami]: Ikegami T, Inatsugi T, Kojima I, Umemura M, Hagiwara H, Machida M, et al. (2015) Hybrid De Novo Genome Assembly Using MiSeq and SOLiD Short Read Data. PLoS ONE 10(4): e0126289. doi:10.1371/journal.pone.0126289\n\n\n[^Kim]: Kim, M., Lee, K.-H., Yoon, S.-W., Kim, B.-S., Chun, J., \n Yi, H. (2013). Analytical Tools and Databases for Metagenomics in the Next-Generation Sequencing Era. Genomics \n Informatics, 11(3), 102\u2013113.\n\n\n[^Gausson]: Gausson, V., \n Saleh, M.-C. (2011). Viral Small RNA Cloning and Sequencing. In Antiviral RNAi - Concepts, Methods, and Applications (pp. 107\u2013122).\n\n\n[^EMBL-EBI]: EMBL-EBI. (n.d.). What is Next-Generation DNA Sequencing. Retrieved June 3, 2016, from https://www.ebi.ac.uk/training/online/course/ebi-next-generation-sequencing-practical-course/what-you-will-learn/what-next-generation-dna-\n\n\n[^Antoniewski]: Antoniewski, C. (2011). Visitor, An Informatic Pipeline for Analysis of Viral siRNA Sequencing Datasets. In Antiviral RNAi - Concepts, Methods, and Applications (pp. 123\u2013142).\n\n\n[^Carissimo]: Carissimo, G., Beek, M. van den, Pegoraro, J., Vernick, K. D., \n Antoniewski, C. (2016). Metavisitor , a suite of Galaxy tools for simple and rapid detection and discovery of viruses in deep sequence data. bioRxiv Preprint.\n\n\n[^Vodovar]: Vodovar, N., Goic, B., \n Saleh, M. (2011). In Silico Reconstruction of Viral Genomes from Small RNAs Improves Virus-Derived Small Interfering, 85(21), 11016\u201311021. http://doi.org/10.1128/JVI.05647-11\n\n\n[^Andrade]: de Andrade, R. R. S., \n Vaslin, M. F. S. (2014). SearchSmallRNA: a graphical interface tool for the assemblage of viral genomes using small RNA libraries data. Virology Journal, 11, 45. http://doi.org/10.1186/1743-422X-11-45\n\n\n[^Kreuze]: Kreuze, J. F., Perez, A., Untiveros, M., Quispe, D., Fuentes, S., Barker, I., \n Simon, R. (2009). Complete viral genome sequence and discovery of novel viruses by deep sequencing of small RNAs: A generic method for diagnosis, discovery and sequencing of viruses. Virology, 388(1), 1\u20137. http://doi.org/10.1016/j.virol.2009.03.024", 
            "title": "Introduction"
        }, 
        {
            "location": "/introduction/#introduction", 
            "text": "The next-generation sequencing (NGS) technologies, also known as high-throughput sequencing, have developped very fast in the past few years. Between the most known technologies there are Illumina, Roche 454 and SOLiD. These platforms are able to produce over billions of short read data every day. This huge amount of data at lower costs enables deep sequencing and enlarge the application possibilities. [^EMBL-EBI] These technologies can, for example, aid the study of metagenomics and the understanding of the host-pathogen interactions. [^Gausson]  Viruses present a high diversity in which concern their genomes. Single or double-stranded, RNA or DNA, linear or circular, as well as different types of replication cycles, intermediates and strategies can hamper viral sequencing and detection. For instance, viruses with no DNA stage can not be detected by DNA sequencing and viruses without poly-A tails are not detected by most mRNA sequencing protocols. [^Kreuze][^Carissimo]  Attempting to avoid this issue and knowing that NGS technologies are suitable for small RNA sequencing, Kreuze  et al.  proposed in 2009 to use vsiRNA as a solution to virus identification. This approach would enable the identification of virus in low concentration as well as new virus with no prior information. [^Kreuze]  RNA interference (RNAi) is one of the mechanisms used by plants and invertebrates in gene expression control. Besides silencing endogenous genes, this process is also a potent antiviral pathway. The Dicer enzyme mediates this process by recognising the viral RNA which is then cleaved in smaller RNA duplex called virus-derived small RNA (vsiRNA). [^Sabin] According to previous studies about Dicer's substract, different forms of viral RNA may be a vsiRNA precursor: double-strand RNA (dsRNA) as well as regions in highly structured hairpin in simple-strand RNA (ssRNA) or messenger RNA (mRNA). DNA virus are also directly identified and cleaved by Dicer enzymes. However, ssRNA virus must be transformed in dsRNA before Dicer recognition. [^Aliyari]  According to Gausson and Saleh, vsiRNA molecules indicate the activation of the antiviral response in the host and its abundance reveals the degree of viral replication and gene expression. [^Gausson] Though vsiRNA molecules have a characterisc length (varying from 21 to 23 nucleotides according to the host), the cleavages distribution in the viral genome remains unclear: some virus are cleaved in limited regions while others are targeted through the whole genome. [^Gausson][^Sabin]  Mapping these small molecules against a reference viral genome can give informations about the nature and the structure of the viral dsRNA. Moreover, as viral genomes evolve fast, it is important to know and to identify viral variants for biological and medical researches. It can be conveniently done by scaffolding vsiRNA short sequences into a known similar reference sequence. [^Gausson][^Vodovar]  Intenting to determine viral variants, Vodovar  et al.  proposed  Paparazzi , a perl script that aims to reconstitute a virus complete genome from vsiRNA and an initial reference sequence as scaffold thanks to an iterative algorithm. The script was tested with small RNA sequencing data from  Drosophila melanogaster  infected with  Nora virus . The study showed that the improved sequence had a higher coverage when compared with the initial  Nora virus  reference genome. [^Vodovar] With the same goal, SearchSmallRNA is a software developed in java that uses a similar approch. [^Andrade]   However, both SearchSmallRNA and Paparazzi present the same combination of cons. At first, they demand some computer skills from users for installation and execution. Secondly, they require a close enough sequence to serve as reference for guiding the algorithm. This preclude the identification of new or unexpected viruses. Lastly, these programs are not currently available for download.  Aiming to release a software able to detect and reconstruct viral genomes from NGS datasets without the problems mentioned above, ARTbio developed Metavisitor, a free and open source set of Galaxy tools and workflows.    [^Ikegami]: Ikegami T, Inatsugi T, Kojima I, Umemura M, Hagiwara H, Machida M, et al. (2015) Hybrid De Novo Genome Assembly Using MiSeq and SOLiD Short Read Data. PLoS ONE 10(4): e0126289. doi:10.1371/journal.pone.0126289  [^Kim]: Kim, M., Lee, K.-H., Yoon, S.-W., Kim, B.-S., Chun, J.,   Yi, H. (2013). Analytical Tools and Databases for Metagenomics in the Next-Generation Sequencing Era. Genomics   Informatics, 11(3), 102\u2013113.  [^Gausson]: Gausson, V.,   Saleh, M.-C. (2011). Viral Small RNA Cloning and Sequencing. In Antiviral RNAi - Concepts, Methods, and Applications (pp. 107\u2013122).  [^EMBL-EBI]: EMBL-EBI. (n.d.). What is Next-Generation DNA Sequencing. Retrieved June 3, 2016, from https://www.ebi.ac.uk/training/online/course/ebi-next-generation-sequencing-practical-course/what-you-will-learn/what-next-generation-dna-  [^Antoniewski]: Antoniewski, C. (2011). Visitor, An Informatic Pipeline for Analysis of Viral siRNA Sequencing Datasets. In Antiviral RNAi - Concepts, Methods, and Applications (pp. 123\u2013142).  [^Carissimo]: Carissimo, G., Beek, M. van den, Pegoraro, J., Vernick, K. D.,   Antoniewski, C. (2016). Metavisitor , a suite of Galaxy tools for simple and rapid detection and discovery of viruses in deep sequence data. bioRxiv Preprint.  [^Vodovar]: Vodovar, N., Goic, B.,   Saleh, M. (2011). In Silico Reconstruction of Viral Genomes from Small RNAs Improves Virus-Derived Small Interfering, 85(21), 11016\u201311021. http://doi.org/10.1128/JVI.05647-11  [^Andrade]: de Andrade, R. R. S.,   Vaslin, M. F. S. (2014). SearchSmallRNA: a graphical interface tool for the assemblage of viral genomes using small RNA libraries data. Virology Journal, 11, 45. http://doi.org/10.1186/1743-422X-11-45  [^Kreuze]: Kreuze, J. F., Perez, A., Untiveros, M., Quispe, D., Fuentes, S., Barker, I.,   Simon, R. (2009). Complete viral genome sequence and discovery of novel viruses by deep sequencing of small RNAs: A generic method for diagnosis, discovery and sequencing of viruses. Virology, 388(1), 1\u20137. http://doi.org/10.1016/j.virol.2009.03.024", 
            "title": "Introduction"
        }, 
        {
            "location": "/intro/galaxy/", 
            "text": "Galaxy\n\n\nGalaxy is an open-source platform used for many types of computational analyses in biomedical data. Originally developed for the genomic field, Galaxy provides today tools for many other disciplines in the life sciences. Galaxy main goal is to support researches in many different biosciences fields, always aiming for:\n\n\n\n\nAccessibility, so any user can run analyses without any programming knowledge\n\n\nReproducibility, to enable users to repeat and understand others' analyses\n\n\nTransparency, encouraging users interaction\n\n\n\n\nTo conform with these ambitions, the Galaxy platform counts with a good documentation in the project wiki. It also hold a participative community from many places around the world and with many fields of interest. \n\n\nA regular user, for example, with no particular computer skills, is apt to realize data analyses in one of the existing instances. For them, Galaxy is very intuitive and the documentation is quite useful. One can start loading its own dataset from the computer or even importing data from known webservers as UCSC and ENA. A series of analyze tools can be easily found and ran. The available tools will vary from instance to instance. The tools may be combined in workflows thanks to a graphical interface. Datasets and workflows can be shared and published through data libraries, histories and pages.\n\n\nA free public server is kept by the Galaxy team, but many other instances are also available. Any organization or user can deploy their own Galaxy instance adapted for their particular needs. They can also develop and publish their own tools, which may also be useful for other users that are then able to easily install the tool in their Galaxy instance. Developpers are encouraged to appropriately document their tools, since other users might want to use it. \n\n\nGalaxy's flexibility and core values are strong enough reasons for making it ARTbio's choice", 
            "title": "Galaxy"
        }, 
        {
            "location": "/intro/galaxy/#galaxy", 
            "text": "Galaxy is an open-source platform used for many types of computational analyses in biomedical data. Originally developed for the genomic field, Galaxy provides today tools for many other disciplines in the life sciences. Galaxy main goal is to support researches in many different biosciences fields, always aiming for:   Accessibility, so any user can run analyses without any programming knowledge  Reproducibility, to enable users to repeat and understand others' analyses  Transparency, encouraging users interaction   To conform with these ambitions, the Galaxy platform counts with a good documentation in the project wiki. It also hold a participative community from many places around the world and with many fields of interest.   A regular user, for example, with no particular computer skills, is apt to realize data analyses in one of the existing instances. For them, Galaxy is very intuitive and the documentation is quite useful. One can start loading its own dataset from the computer or even importing data from known webservers as UCSC and ENA. A series of analyze tools can be easily found and ran. The available tools will vary from instance to instance. The tools may be combined in workflows thanks to a graphical interface. Datasets and workflows can be shared and published through data libraries, histories and pages.  A free public server is kept by the Galaxy team, but many other instances are also available. Any organization or user can deploy their own Galaxy instance adapted for their particular needs. They can also develop and publish their own tools, which may also be useful for other users that are then able to easily install the tool in their Galaxy instance. Developpers are encouraged to appropriately document their tools, since other users might want to use it.   Galaxy's flexibility and core values are strong enough reasons for making it ARTbio's choice", 
            "title": "Galaxy"
        }, 
        {
            "location": "/metavisitor/", 
            "text": "Since it is based on the Galaxy plataform, Metavisitor is more accessible to users with no specific skills. The graphical workflow editor makes it easier to understand and adapt the chain of processing steps", 
            "title": "Metavisitor"
        }, 
        {
            "location": "/intro/vir1/", 
            "text": "Reference viral sequences\n\n\nThe results obtained by the Galaxy pipeline are very dependent on the database used as reference. Indeed, those sequences may guide one or two decisive steps. \n\n\nThe matching reads from the second bowtie step, for instance, vary a lot according to the reference dataset used. Naturally, this step can be skipped, but for some sequencing datasets this would represent a heavy workload. In this cases, we use this second bowtie step to reduce the number of reads, keeping only those considered as viral. Whence the importance of having an appropriate reference database. If this database does not include as many viral sequences as known, some viral reads will be rejected, debilitating the following assembling steps. Nevertheless, there is no interest in keeping a redundant reference database, since the bowtie step will take longer and the results will not be improved.\n\n\nThe second step involving the reference database is the BLAST alignment of Oases \nde novo\n contigs against those known viral sequences. This step is important for picking the proper contigs between the possibilities given by the assembling. Again, a reference database lacking information will disturb the pipeline performance. And a redundant database will only slow down the process.\n\n\nWith the sequencing technologies more accessible, the amount of protein and nucleotides sequences is rapidly increasing. However, new sequence does not mean more information, since many of the new sequences are similar to alread known sequences. These alike sequences may indicate variant species, polymorphisms or even alignement errors. Either way, this high redundancy in a database represent a higher time and resource comsumption in subsequent analyses without any true profit.\n\n\nBetween the numerous biological databases, a few propose to store huge amount of nucleotide and protein data. These sequence databases often propose different approaches for organising such data. In fact, redundancy in the biological field is a very complex concept that do not fit a single definition. So, there are databases that try to eliminate redundancy by automated measures, other by manual curation and others will even neglect redundancy willing for completeness. [^Robison]\n\n\nGenBank is an example of non-curated database. Its entries are submitted by individual laboratories or large-scale sequencing centers. Besides its redundancy, they can contain errors and discordances between sequences, names and other informations. GenBank, EMBL (European Molecular Biology Laboratory) and DDBJ (DNA Data Bank of Japan) are supposed to contain the same database, but it is not always true thanks to timelags in propagating data between them. Still, when updated and merged, these databases achieve a wordwide coverage, regardless of its redundancy. [^Robison] [^Pruitt]\n\n\nRefSeq, on the other hand, is managed by NCBI staff and contains \"non-redudant\" reviewed sequences. These sequences are well-annotated and contain supplementary information. Unfortunatly, not all known sequences have been reviewed, which makes RefSeq a non-redundant but not-complete collection. [^Pruitt]\n\n\nIn the case of protein sequence databases, SwissProt is known as a \"highly-curated, highly-crossreferenced and non-redundant database\". Its entries are manualy curated so there is a single entry per protein product, which might also present protein variants annotations and references to other databases. However, this process high cost reflects in the absence of some sequences not yet curated by SwissProt. [^Robison]\n\n\n\n\n\nFor Metavisitor's goals, it is important to have a viral reference database as complete as it can get. For doing so, we choose to not to restrict it to the non-redundant databases. Instead, we will look for reducing redundancy on sequences sets comming from every database in NCBI.\n\n\n\n\n[^Pruitt]: Pruitt, K. D., Tatusova, T., \n Maglott, D. R. (2007). NCBI reference sequences (RefSeq): A curated non-redundant sequence database of genomes, transcripts and proteins. Nucleic Acids Research, 35(SUPPL. 1), 501\u2013504. http://doi.org/10.1093/nar/gkl842\n\n\n[^Robison]: Robison, K. (n.d.). What is Redundancy? Retrieved from http://arep.med.harvard.edu/seqanal/db.html", 
            "title": "Reference database"
        }, 
        {
            "location": "/intro/vir1/#reference-viral-sequences", 
            "text": "The results obtained by the Galaxy pipeline are very dependent on the database used as reference. Indeed, those sequences may guide one or two decisive steps.   The matching reads from the second bowtie step, for instance, vary a lot according to the reference dataset used. Naturally, this step can be skipped, but for some sequencing datasets this would represent a heavy workload. In this cases, we use this second bowtie step to reduce the number of reads, keeping only those considered as viral. Whence the importance of having an appropriate reference database. If this database does not include as many viral sequences as known, some viral reads will be rejected, debilitating the following assembling steps. Nevertheless, there is no interest in keeping a redundant reference database, since the bowtie step will take longer and the results will not be improved.  The second step involving the reference database is the BLAST alignment of Oases  de novo  contigs against those known viral sequences. This step is important for picking the proper contigs between the possibilities given by the assembling. Again, a reference database lacking information will disturb the pipeline performance. And a redundant database will only slow down the process.  With the sequencing technologies more accessible, the amount of protein and nucleotides sequences is rapidly increasing. However, new sequence does not mean more information, since many of the new sequences are similar to alread known sequences. These alike sequences may indicate variant species, polymorphisms or even alignement errors. Either way, this high redundancy in a database represent a higher time and resource comsumption in subsequent analyses without any true profit.  Between the numerous biological databases, a few propose to store huge amount of nucleotide and protein data. These sequence databases often propose different approaches for organising such data. In fact, redundancy in the biological field is a very complex concept that do not fit a single definition. So, there are databases that try to eliminate redundancy by automated measures, other by manual curation and others will even neglect redundancy willing for completeness. [^Robison]  GenBank is an example of non-curated database. Its entries are submitted by individual laboratories or large-scale sequencing centers. Besides its redundancy, they can contain errors and discordances between sequences, names and other informations. GenBank, EMBL (European Molecular Biology Laboratory) and DDBJ (DNA Data Bank of Japan) are supposed to contain the same database, but it is not always true thanks to timelags in propagating data between them. Still, when updated and merged, these databases achieve a wordwide coverage, regardless of its redundancy. [^Robison] [^Pruitt]  RefSeq, on the other hand, is managed by NCBI staff and contains \"non-redudant\" reviewed sequences. These sequences are well-annotated and contain supplementary information. Unfortunatly, not all known sequences have been reviewed, which makes RefSeq a non-redundant but not-complete collection. [^Pruitt]  In the case of protein sequence databases, SwissProt is known as a \"highly-curated, highly-crossreferenced and non-redundant database\". Its entries are manualy curated so there is a single entry per protein product, which might also present protein variants annotations and references to other databases. However, this process high cost reflects in the absence of some sequences not yet curated by SwissProt. [^Robison]   For Metavisitor's goals, it is important to have a viral reference database as complete as it can get. For doing so, we choose to not to restrict it to the non-redundant databases. Instead, we will look for reducing redundancy on sequences sets comming from every database in NCBI.   [^Pruitt]: Pruitt, K. D., Tatusova, T.,   Maglott, D. R. (2007). NCBI reference sequences (RefSeq): A curated non-redundant sequence database of genomes, transcripts and proteins. Nucleic Acids Research, 35(SUPPL. 1), 501\u2013504. http://doi.org/10.1093/nar/gkl842  [^Robison]: Robison, K. (n.d.). What is Redundancy? Retrieved from http://arep.med.harvard.edu/seqanal/db.html", 
            "title": "Reference viral sequences"
        }, 
        {
            "location": "/matandmet/entrezquery/", 
            "text": "Retrieve from NCBI\n\n\nIn order to reduce the reference database, we started reviewing the sequences retrieved from NCBI. The retrieval is done with an Entrez query and an E-utilities based tool.\n\n\nEntrez query\n\n\nEntrez search system is a powerful serch mechanism for exploring the NCBI database as it allows focused searches for getting precise results. The Entrez system embraces 39 databases for different types of molecules and literature. In Metavisitor's case, we will interest in two of these datasets: the nucleotide and the protein databases.\n\n\nThe first version of the reference viral sequences databases for nucleotides and proteins were both called \nvir1\n. They were retrieved using the the exact same Entrez query, only changing the NCBI database used. The initial commom Entrez query was:\n\n\ntxid10239[Organism] NOT txid131567[Organism] NOT phage[All Fields]\n\n\nIn NCBI, the taxonomy ID (txid) represents a lineage of organisms. IDs can be found in the \nNCBI Taxonomy Homepage\n. \n\n\nWe start getting all the viruses (txid10239) organisms making sure cellular organism (txid131567) and phages are filtered out. The retrieved database is very redundant and contains many poorly annotated sequences.\n\n\nSince the following steps are going to be very resource consumming, we need to eliminate in this step as many unwanted sequences as possible. Many reasons can lead a sequence to be undesired in the viral reference database, essentially we want all of them to be informative and to have a human readable header. We studied the retrieved sequences for both databases. Besides some commom filters, they have also their particularities which are explained next.\n\n\nNucleotide database\n\n\nThe nucleotide database, also called \nnuccore\n, includes all sequence data from GenBank, EMBL (European Molecular Biology Laboratory) and DDBJ (DNA Data Bank of Japan). It also contains the Reference Sequences (RefSeq) and nucleotide sequences extracted from structure records from the Protein Databank (PDB).\n\n\nThe Entrez query with new filters proposed for the Nucleotide database is the following:\n\n\n\n\n\n\n\n\n\nPatent\n\n\nNot only most patent sequences are extremely short (below 100 nucleotides), but also they are predominantly redundant with non-patent sequences. Besides, their title are almost always not representing the source organism.\n\n\n\n\n\n\nUnverified\n\n\nUnverified sequences are sequences marked by GenBank staff as containning issues. In fact Genbank staff are reponsible for verifying the sequences and annotations accuracies. When they can not do it, the sequence is tagged as \"UNVERIFIED\" in its title until the submitter resolves the problems. These sequences are not included in the BLAST database and they should neither be included in the viral reference database. [^Genbank]\n\n\n\n\n\n\nChimeric\n\n\nChimeric sequences are hybrids between two or more different organisms. Only a few vir1 sequences are chimeric. \n\n\n\n\n\n\nVector\n\n\nA vector is a tool used in molecular biology to deliver genetic material into another cell. They are genetically engeneered from viral or cellular genetic material. Entries containing this word in the title usually present artificial sequences.\n\n\n\n\n\n\nMethod\n\n\nSome NCBI entries concern methods for molecular and cellular biology. Their title do not indicate what the sequence is neither its source. There is always some better anottated sequence for the same source organism.\n\n\n\n\n\n\nUncultured virus\n\n\nSome sequences present \"uncultured virus\" as their source organism, which does not inform much about the sequence origin.\n\n\n\n\n\n\nLength\n\n\nNCBI contains many viral sequences below 100 nucleotides. These sequences are simutaneously not much informative and quite redundant with the rest of the database. They would increase the processing resources needs without adding results.\n\n\nThe Entrez query syntax for defining the Sequences LENgth (SLEN) requires high and low thresholds. So, we define a high threshold that is certainly going to embrace every viral sequence.\n\n\n\n\n\n\nFor reasons that are going to be explained afterwards, we will have to retrieve nucleotide sequences in two separated sets. The first datasets will contain only RefSeq entries that will be picked by adding the filter \nAND RefSeq[Filter]\n. The second includes only non-RefSeq entries which means a \nNOT RefSeq[Filter]\n must be added in the Entrez query.  \n\n\nProtein database\n\n\nThe protein database contains sequences from Protein Information Resource (PIR), UniProtKB/Swiss-Prot and Protein Research Foundation (PRF) as well as amino acid sequences obtained from the coding regions from all nucleotide records also included in Nuccore.\n\n\nFor the protein dataase, the proposed Entrez query with filter is the following:\n\n\n\n\n\n\n\n\n\nUnverified\n\n\nFor the same reasons as explained for the nucleotide dataset, unverified sequences are excluded from the reference dataset.\n\n\n\n\n\n\nVirus-like particles (VLP)\n\n\nAs described by Brand\u00e3o \net al.\n, VLPs \"are multiprotein structures that mimic the organization and the conformation of authentic native viruses but lack the viral genome\". They are used in different fields,  as vaccines, gene therapy and viral protein studies. Since they are not genuine viruses, they are not reference sequences.\n\n\n\n\n\n\nChimeric\n\n\nFor the same reason as the nucleotide database.\n\n\n\n\n\n\nVector\n\n\nFor the same reason as the nucleotide database.\n\n\n\n\n\n\nMethod\n\n\nFor the same reason as the nucleotide database.\n\n\n\n\n\n\nLength\n\n\nThe thresholds chosen for nucleotide sequences are not convinient for proteins. Protein sequences are shorter. We will consider that the shorter significative sequence has at least 30 amino acids, which is just a bit shorter than the correspondent minimum of 100 nucleotides. To comprise the longest sequences, the high threshold is defined at 10000 amino acids. \n\n\n\n\n\n\nThe protein sequences are also separated in two datasets. The first one, comprising data from curated databases (RefSeq, SwissProt, PIR and PDB), will be retrieved with the extra filter \nAND (RefSeq[Filter] OR SwissProt[Filter] OR PIR[Filter] OR PDB[Filter])\n. The remaining data belongs to the second set adding to the query: \nNOT (RefSeq[Filter] OR SwissProt[Filter] OR PIR[Filter] OR PDB[Filter])\n.\n\n\nRetrieve FASTA from NCBI\n tool\n\n\nFor retrieving the sequences from NCBI according to the chosen Entrez query, we use a Galaxy tool developed in python and called \nRetrieve FASTA from NCBI\n. This tool uses the Entrez Programming Utilities (\nE-utilities\n) which offers a stable interface connection into the Entrez query and the NCBI databases. \n\n\nAfter connecting with the chosen database (nuccore or protein) and retrieving the sequences by batches, this tool also sanitazes the data by formatting the header and skipping problematic sequences. The skiped sequences are either empty or contain ambiguous nucleotides.\n\n\n\n\n\n\n\n[^Genbank]: Benson, D. A., Karsch-Mizrachi, I., Clark, K., Lipman, D. J., Ostell, J., \n Sayers, E. W. (2012). GenBank. Nucleic Acids Research, 40(D1), 48\u201353. http://doi.org/10.1093/nar/gkr1202\n\n\n[^Rold\u00e3o]: Rold\u00e3o, A., Mellado, M. C. M., Castilho, L. R., Carrondo, M. J., \n Alves, P. M. (2010). Virus-like particles in vaccine development. Expert Review of Vaccines, 9(10), 1149\u20131176. http://doi.org/10.1586/erv.10.115", 
            "title": "Viral sequences reference"
        }, 
        {
            "location": "/matandmet/entrezquery/#retrieve-from-ncbi", 
            "text": "In order to reduce the reference database, we started reviewing the sequences retrieved from NCBI. The retrieval is done with an Entrez query and an E-utilities based tool.", 
            "title": "Retrieve from NCBI"
        }, 
        {
            "location": "/matandmet/entrezquery/#entrez-query", 
            "text": "Entrez search system is a powerful serch mechanism for exploring the NCBI database as it allows focused searches for getting precise results. The Entrez system embraces 39 databases for different types of molecules and literature. In Metavisitor's case, we will interest in two of these datasets: the nucleotide and the protein databases.  The first version of the reference viral sequences databases for nucleotides and proteins were both called  vir1 . They were retrieved using the the exact same Entrez query, only changing the NCBI database used. The initial commom Entrez query was:  txid10239[Organism] NOT txid131567[Organism] NOT phage[All Fields]  In NCBI, the taxonomy ID (txid) represents a lineage of organisms. IDs can be found in the  NCBI Taxonomy Homepage .   We start getting all the viruses (txid10239) organisms making sure cellular organism (txid131567) and phages are filtered out. The retrieved database is very redundant and contains many poorly annotated sequences.  Since the following steps are going to be very resource consumming, we need to eliminate in this step as many unwanted sequences as possible. Many reasons can lead a sequence to be undesired in the viral reference database, essentially we want all of them to be informative and to have a human readable header. We studied the retrieved sequences for both databases. Besides some commom filters, they have also their particularities which are explained next.", 
            "title": "Entrez query"
        }, 
        {
            "location": "/matandmet/entrezquery/#nucleotide-database", 
            "text": "The nucleotide database, also called  nuccore , includes all sequence data from GenBank, EMBL (European Molecular Biology Laboratory) and DDBJ (DNA Data Bank of Japan). It also contains the Reference Sequences (RefSeq) and nucleotide sequences extracted from structure records from the Protein Databank (PDB).  The Entrez query with new filters proposed for the Nucleotide database is the following:     Patent  Not only most patent sequences are extremely short (below 100 nucleotides), but also they are predominantly redundant with non-patent sequences. Besides, their title are almost always not representing the source organism.    Unverified  Unverified sequences are sequences marked by GenBank staff as containning issues. In fact Genbank staff are reponsible for verifying the sequences and annotations accuracies. When they can not do it, the sequence is tagged as \"UNVERIFIED\" in its title until the submitter resolves the problems. These sequences are not included in the BLAST database and they should neither be included in the viral reference database. [^Genbank]    Chimeric  Chimeric sequences are hybrids between two or more different organisms. Only a few vir1 sequences are chimeric.     Vector  A vector is a tool used in molecular biology to deliver genetic material into another cell. They are genetically engeneered from viral or cellular genetic material. Entries containing this word in the title usually present artificial sequences.    Method  Some NCBI entries concern methods for molecular and cellular biology. Their title do not indicate what the sequence is neither its source. There is always some better anottated sequence for the same source organism.    Uncultured virus  Some sequences present \"uncultured virus\" as their source organism, which does not inform much about the sequence origin.    Length  NCBI contains many viral sequences below 100 nucleotides. These sequences are simutaneously not much informative and quite redundant with the rest of the database. They would increase the processing resources needs without adding results.  The Entrez query syntax for defining the Sequences LENgth (SLEN) requires high and low thresholds. So, we define a high threshold that is certainly going to embrace every viral sequence.    For reasons that are going to be explained afterwards, we will have to retrieve nucleotide sequences in two separated sets. The first datasets will contain only RefSeq entries that will be picked by adding the filter  AND RefSeq[Filter] . The second includes only non-RefSeq entries which means a  NOT RefSeq[Filter]  must be added in the Entrez query.", 
            "title": "Nucleotide database"
        }, 
        {
            "location": "/matandmet/entrezquery/#protein-database", 
            "text": "The protein database contains sequences from Protein Information Resource (PIR), UniProtKB/Swiss-Prot and Protein Research Foundation (PRF) as well as amino acid sequences obtained from the coding regions from all nucleotide records also included in Nuccore.  For the protein dataase, the proposed Entrez query with filter is the following:     Unverified  For the same reasons as explained for the nucleotide dataset, unverified sequences are excluded from the reference dataset.    Virus-like particles (VLP)  As described by Brand\u00e3o  et al. , VLPs \"are multiprotein structures that mimic the organization and the conformation of authentic native viruses but lack the viral genome\". They are used in different fields,  as vaccines, gene therapy and viral protein studies. Since they are not genuine viruses, they are not reference sequences.    Chimeric  For the same reason as the nucleotide database.    Vector  For the same reason as the nucleotide database.    Method  For the same reason as the nucleotide database.    Length  The thresholds chosen for nucleotide sequences are not convinient for proteins. Protein sequences are shorter. We will consider that the shorter significative sequence has at least 30 amino acids, which is just a bit shorter than the correspondent minimum of 100 nucleotides. To comprise the longest sequences, the high threshold is defined at 10000 amino acids.     The protein sequences are also separated in two datasets. The first one, comprising data from curated databases (RefSeq, SwissProt, PIR and PDB), will be retrieved with the extra filter  AND (RefSeq[Filter] OR SwissProt[Filter] OR PIR[Filter] OR PDB[Filter]) . The remaining data belongs to the second set adding to the query:  NOT (RefSeq[Filter] OR SwissProt[Filter] OR PIR[Filter] OR PDB[Filter]) .", 
            "title": "Protein database"
        }, 
        {
            "location": "/matandmet/entrezquery/#retrieve-fasta-from-ncbi-tool", 
            "text": "For retrieving the sequences from NCBI according to the chosen Entrez query, we use a Galaxy tool developed in python and called  Retrieve FASTA from NCBI . This tool uses the Entrez Programming Utilities ( E-utilities ) which offers a stable interface connection into the Entrez query and the NCBI databases.   After connecting with the chosen database (nuccore or protein) and retrieving the sequences by batches, this tool also sanitazes the data by formatting the header and skipping problematic sequences. The skiped sequences are either empty or contain ambiguous nucleotides.    [^Genbank]: Benson, D. A., Karsch-Mizrachi, I., Clark, K., Lipman, D. J., Ostell, J.,   Sayers, E. W. (2012). GenBank. Nucleic Acids Research, 40(D1), 48\u201353. http://doi.org/10.1093/nar/gkr1202  [^Rold\u00e3o]: Rold\u00e3o, A., Mellado, M. C. M., Castilho, L. R., Carrondo, M. J.,   Alves, P. M. (2010). Virus-like particles in vaccine development. Expert Review of Vaccines, 9(10), 1149\u20131176. http://doi.org/10.1586/erv.10.115", 
            "title": "Retrieve FASTA from NCBI tool"
        }, 
        {
            "location": "/matandmet/cluster/", 
            "text": "Once the sequences have been retrieved using the Entrez queries described before, the cluster step can get started. Indeed, the data retrieved is still very redundant. \n\n\nObviously, redundancy in biological data is not a novelty. Thus, there are a list of tools already developed aiming to reduce or resolve this problem. The question being what software is the best adapted to our scenario.\n\n\nBesides the big amount of data available, another issue with clustering sequences is that to compute distances between elements, sequences alignments are required. Biological sequences present deletions, insertions and mutations what makes it quite complex to determine the distances between every sequence. Besides, the sequences length will impact significantly in the time processing required. To reduce this problem, some algorithm found alternatives for calculating pairwise distance wisely. \n\n\nThere are two main types of sequence clustering algorithms for biological sequences. They are discussed below:\n\n\nHierarchical Clustering\n\n\nHierarchical clustering algorithms are applied in many different data fields. Most of them have quadratic space and computation complexities (\nO\n(n\n2\n)), which means that the complexity grows quadratically with the number of elements in the dataset. This implies a data size limitation too restrictive for our case. [^Cai] \n\n\nESPRIT-Tree\n\n\nSome new algorithms propose methods for reducing its complexity and the processing time. It is the case of ESPRIT-Tree, a recent hierarchical clustering algorithm that uses the concept of space partition. Unlike most hierarchical clustering algorithms, ESPRIT-Tree does not build a distance matrix, every distance is calculated as needed. It uses a \"devide-and-conquer-based strategy\" which assures a quasilinear complexity. All the informations about ESPRIT-Tree algorithm and particularities are described in its paper \nESPRIT-Tree: Hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time\n (Cai \n Sun)\n.\n\n\nThe software clusters the elements within a pseudometric based partition (PBP) tree, a tree that contains multiple levels uniformly spaced in a logarithmic scale. It is built incrementally by adding sequence by sequence in the tree. For each new sequence, its distance to the center of existing nodes will determine its position. If this pairwise distance is greater than a given threshold, a new node is created. Else, the sequence is absorbed inside the node and it is compared with the nodes in the lower level. This process repeats until the new sequences reaches the leafs level. Another new sequence will then be added in the PBP tree. To avoid the risk of overlapping the clusters hyperspaces, the software opts by adding the new sequence within the first cluster matching the condition, instead of the closest cluster. This step complexity is on the order of \nO\n(N).\n\n\nThen, this tree needs to be refined so the closest pairs of clusters are grouped together. A naive calculation of distances between every pair of cluster to determine the minima takes \nO\n(N\n2\n) operations. However, thanks to the PBP tree, nearest neighbors sequences can be found locally since they are always in the same or adjacent cluster spaces. Taking this advantage, the minimal distances can be found in \nO\n(log N) time and \nO\n(N) space using pseudometric space triangular inequalities.\n\n\nAnother improvement implemented by ESPRIT-Tree concerns the pairwise distance calculation. As said before, computing distances between sequences is a lot more mathematically challenging than the distances between numeric-valued vectors. When comparing sequences with different lengths, an alignment is needed. ESPRIT-Tree uses probabilistic sequences to facilitate the task. A probabilistic sequence is a statistical model that describes a group of sequences. These virtual sequences are aligned using the probabilistic Needleman-Wunsch algorithm, a generalization of the Needleman-Wunsch algorithm. Thanks to this algorithm, pairwise distances will be calculated as an approximation of the probabilistic average distance between two probabilistic sequences.\n\n\nTo reduce the workload required for doing all the alignements, ESPRIT-Tree also uses the \nk\n-mer distances strategy. With this method it is possible to avoid many unnecessary alignments in the PBP tree construction and in the clustering refinement. This technique will be discussed in the CD-HIT section.\n\n\nAccording to ESPRIT-Tree official \nwebsite\n, the software is being optimized and a beta version is available upon request. Yet, our request never got an answer from the author.\n\n\nGreedy Heuristic Clustering\n\n\nGreedy heuristic clustering are another approach used to cluster sequences. Two of the most used algorithms are CD-HIT and UCLUST. As greedy algorithms, they try to approximate the global optimal solution in a reasonable time consumption. These algorithms are mostly faster than hierarchical clustering algorithms, but they tend to be less accurate. \n\n\nThe input sequences are processed sequentially by the algorithm. Already processed sequences can be of two types: representative or redundant. Redundant sequences are illustrated by representative sequences, so, they can be excluded from further analysis. Every new sequence is compared with the representative sequences. If the pairwise distance is smaller than a given threshold, than the new sequence is considered redundant. Otherwise, it is a representative sequence that will be part of following analysis.\n\n\nThe process described is the main process followed by this class of clustering algorithms. However, different software presents particularities in its methods and definitions. This differences will be detailed below.\n\n\nOverall, these algorithms' computational complexity is on the order of \nO\n(NM), where N indicates the number of sequences in the input and M is the number of representative sequences. Therefore, their resources consumption is quite hard to predict since the data redundancy may be unknown until the algorithm is run. [^Cai]\n\n\n\n\n\n\n\n\nCD-HIT and CD-HIT-EST\n\n\nOriginally developed to protein sequences clustering in 2001, this software was extended for nucleotides sequences in 2006. The algorithm supporting nucleotides clustering received the name CD-HIT-EST. CD-HIT package also includes many other binaries and perl scripts used to compare two databases, identify overlapping reads, etc. Since 2012, CD-HIT can run in multiple-thread, reducing the database size limitations.[^Li] CD-HIT's informations were retrieved from its \nuser's guide\n. \n\n\nCD-HIT's algorithm starts by ordering the sequences from the longest to the shortest. The longest sequence is automatically a representative sequence. Then, as explained before, every other sequence will be classified as redundant or representative according to the sequences already classified as representative. The user can choose if redundant sequences should go to the first matching cluster (fast mode) or to the closest cluster after comparison with all representative sequences (accurate mode).\n\n\nFor speeding up its execution, CD-HIT uses a heuristic for reducing the amount of alignments. It consists in choosing which pairwise alignments are worth computing according to the common short words.\n\n\nA short word or k-mer is a small sequence of k nucleotides (for DNAs) or amino acids (for proteins) from a bigger sequence. A linear sequence contains L-k+1 k-mers, where L is the sequence length. The combination and the repetition of those k-mers vary from sequence to sequence and that is the big advantage of using short word filters.\n\n\nAt first, an index table for the whole database must be built. Every unique k-mer has a unique index that indicates how many times this k-mer appears within each sequence. Then, thanks to previous studies on real alignments, we know statistically how many common k-mers two sequences must have so they share a particular identity. If the number of common k-mers is too low, than the algorithm can predict these sequences are not similar without performing the alignment.\n\n\nThis process means a significant gain in the algorithm's efficiency, since accessing information in a index table can be done quite fast. Besides, CD-HIT uses a k from 2 to 5 for proteins and a k from 8 to 12 for DNA, making sure all unique k-mers can be indexed in computer memory. For instance, there are, at most, 4\n12\n = 16M different k-mers with k=12. The suggested k value for each identity range is indicated in the user's manual.\n\n\nHowever, as the quantity of common k-mers needed vary according to sequences length and alignment identities, the CD-HIT algorithm presents some limitations. With too long sequences or for too small identities thresholds, common k-mers counting are no longer good predictors. For this reason, CD-HIT suggests a identity minima between protein sequences at 40% and CD-HIT-EST suggests 75% for nucleotide sequences. For other cases (low identity or genome sized sequences), CD-HIT proposes the PSI-CD-HIT script.\n\n\nPSI-CD-HIT is a perl script that can be used for both protein and nucleotide sequences. Its algorithm is similar to CD-HIT and CD-HIT-EST's, but it does not use the k-mers filters. Each sequence is compared to the representative sequences identified so far through BLAST (blastp, blastn or megablast). Thus, it is less efficient and it is only recommended for those particular cases where the classic programs are inadequate. \n\n\nAnother CD-HIT package limitation is that its output is influenced by the input sequences order.\n\n\nCD-HIT's outputs\n\n\nCD-HIT's algorithms output two files. One is a fasta file containing all the dataset representative sequences. The other is a clstr file where each sequence cluster is described. A \"\n\" starts a cluster description and is followed by the cluster id. The following lines present sequences informations (id, length, header and identity). The \"*\" indicates the representative sequence, every other sequence inside a cluster is redundant with the representative.\n\n\nThe following clstr example was extracted from the user's manual:\n\n\nCluster 0\n0 2799aa, \nPF04998.6|RPOC2_CHLRE/275-3073... *\n\nCluster 1\n0 2214aa, \nPF06317.1|Q6Y625_9VIRU/1-2214... at 80%\n1 2215aa, \nPF06317.1|O09705_9VIRU/1-2215... at 84%\n2 2217aa, \nPF06317.1|Q6Y630_9VIRU/1-2217... *\n3 2216aa, \nPF06317.1|Q6GWS6_9VIRU/1-2216... at 84%\n4 527aa, \nPF06317.1|Q67E14_9VIRU/6-532... at 63%\n\n\n\n\nUCLUST\n\n\nUCLUST's algorithm is part of the USEARCH package. Its binary files are available upon request in its \nwebsite\n. The 32-bit version is free, including for commercial uses. However, unlike the 64-bit paid version, it has a limitation of 4Gb RAM. User's manual is available in the \nwebsite\n. \n\n\nIn UCLUST, representative sequences are called centroids. They were once called seeds too, but this term is now obsolete. Centroids are in the center of the cluster which is represented by a circle of radius equal to the identity threshold. UCLUST can be used to both protein and nucleotide sequences. There are two clustering algorithms: cluster_fast and cluster_smallmem. Cluster_fast can sort the input sequences by decreasing length or decreasing abundance before clustering. Cluster_smallmem, contrarily, only processes the input in the order they are given.\n\n\nThe main difference from CD-HIT's algorithm is the sequences comparison. UCLUST uses the USEARCH algorithm. This algorithm also uses short word filters but in a slightly different way. The amount of k-mers shared between sequences guides the comparisons order. Centroids sequences are sorted by decreasing unique word count, that is, centroids that have more common unique k-mers are going to be aligned to the new sequence first. This means that the first time a pairwise alignment is found, it is likely to be the best alignment in the database. Plus, the more comparisons are done without finding a hit, the less likely it is that a hit exists in the database. This represents a big gain in efficiency, since it reduces the amount of alignements a sequence suites before realising it is not redundant.\n\n\n\n\nidentity calc\n\n\nmemory limitation\n\n\n\n\nUCLUST's outputs\n\n\nVCLUST\n\n\nViral reference database case\n\n\n\n\nShow graphic from ESPRIT-Tree paper that shows time consumption + my predictions\n\n\nTest cd-hit parallelizations\n\n\nExplain that we care more about rapidity than accuracy\n\n\nTalk about database size and length distribution\n\n\n\n\n\n\n[^Cai]: Cai, Y., \n Sun, Y. (2011). ESPRIT-Tree: Hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time. Nucleic Acids Research, 39(14), 1\u201310. http://doi.org/10.1093/nar/gkr349\n\n\n[^Kim]: Kim, M., Lee, K.-H., Yoon, S.-W., Kim, B.-S., Chun, J., \n Yi, H. (2013). Analytical Tools and Databases for Metagenomics in the Next-Generation Sequencing Era. Genomics \n Informatics, 11(3), 102\u2013113.\n\n\n[^Edgar]: Edgar, R. C. (2010). Search and clustering orders of magnitude faster than BLAST. Bioinformatics, 26(19), 2460\u20132461. http://doi.org/10.1093/bioinformatics/btq461\n\n\n[^Fu]: Fu, L., Niu, B., Zhu, Z., Wu, S., \n Li, W. (2012). CD-HIT: Accelerated for clustering the next-generation sequencing data. Bioinformatics, 28(23), 3150\u20133152. http://doi.org/10.1093/bioinformatics/bts565\n\n\n[^Quarst]: Quast, C., Pruesse, E., Yilmaz, P., Gerken, J., Schweer, T., Glo, F. O., \n Yarza, P. (2013). The SILVA ribosomal RNA gene database project : improved data processing and web-based tools. Nucleic Acids Research, 41(November 2012), 590\u2013596. http://doi.org/10.1093/nar/gks1219\n\n\n[^Li]: Li, W., Fu, L., Niu, B., Wu, S., \n Wooley, J. (2015). CD-HIT User\u2019s Guide CD-HIT.", 
            "title": "Cluster softwares"
        }, 
        {
            "location": "/matandmet/cluster/#hierarchical-clustering", 
            "text": "Hierarchical clustering algorithms are applied in many different data fields. Most of them have quadratic space and computation complexities ( O (n 2 )), which means that the complexity grows quadratically with the number of elements in the dataset. This implies a data size limitation too restrictive for our case. [^Cai]", 
            "title": "Hierarchical Clustering"
        }, 
        {
            "location": "/matandmet/cluster/#esprit-tree", 
            "text": "Some new algorithms propose methods for reducing its complexity and the processing time. It is the case of ESPRIT-Tree, a recent hierarchical clustering algorithm that uses the concept of space partition. Unlike most hierarchical clustering algorithms, ESPRIT-Tree does not build a distance matrix, every distance is calculated as needed. It uses a \"devide-and-conquer-based strategy\" which assures a quasilinear complexity. All the informations about ESPRIT-Tree algorithm and particularities are described in its paper  ESPRIT-Tree: Hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time  (Cai   Sun) .  The software clusters the elements within a pseudometric based partition (PBP) tree, a tree that contains multiple levels uniformly spaced in a logarithmic scale. It is built incrementally by adding sequence by sequence in the tree. For each new sequence, its distance to the center of existing nodes will determine its position. If this pairwise distance is greater than a given threshold, a new node is created. Else, the sequence is absorbed inside the node and it is compared with the nodes in the lower level. This process repeats until the new sequences reaches the leafs level. Another new sequence will then be added in the PBP tree. To avoid the risk of overlapping the clusters hyperspaces, the software opts by adding the new sequence within the first cluster matching the condition, instead of the closest cluster. This step complexity is on the order of  O (N).  Then, this tree needs to be refined so the closest pairs of clusters are grouped together. A naive calculation of distances between every pair of cluster to determine the minima takes  O (N 2 ) operations. However, thanks to the PBP tree, nearest neighbors sequences can be found locally since they are always in the same or adjacent cluster spaces. Taking this advantage, the minimal distances can be found in  O (log N) time and  O (N) space using pseudometric space triangular inequalities.  Another improvement implemented by ESPRIT-Tree concerns the pairwise distance calculation. As said before, computing distances between sequences is a lot more mathematically challenging than the distances between numeric-valued vectors. When comparing sequences with different lengths, an alignment is needed. ESPRIT-Tree uses probabilistic sequences to facilitate the task. A probabilistic sequence is a statistical model that describes a group of sequences. These virtual sequences are aligned using the probabilistic Needleman-Wunsch algorithm, a generalization of the Needleman-Wunsch algorithm. Thanks to this algorithm, pairwise distances will be calculated as an approximation of the probabilistic average distance between two probabilistic sequences.  To reduce the workload required for doing all the alignements, ESPRIT-Tree also uses the  k -mer distances strategy. With this method it is possible to avoid many unnecessary alignments in the PBP tree construction and in the clustering refinement. This technique will be discussed in the CD-HIT section.  According to ESPRIT-Tree official  website , the software is being optimized and a beta version is available upon request. Yet, our request never got an answer from the author.", 
            "title": "ESPRIT-Tree"
        }, 
        {
            "location": "/matandmet/cluster/#greedy-heuristic-clustering", 
            "text": "Greedy heuristic clustering are another approach used to cluster sequences. Two of the most used algorithms are CD-HIT and UCLUST. As greedy algorithms, they try to approximate the global optimal solution in a reasonable time consumption. These algorithms are mostly faster than hierarchical clustering algorithms, but they tend to be less accurate.   The input sequences are processed sequentially by the algorithm. Already processed sequences can be of two types: representative or redundant. Redundant sequences are illustrated by representative sequences, so, they can be excluded from further analysis. Every new sequence is compared with the representative sequences. If the pairwise distance is smaller than a given threshold, than the new sequence is considered redundant. Otherwise, it is a representative sequence that will be part of following analysis.  The process described is the main process followed by this class of clustering algorithms. However, different software presents particularities in its methods and definitions. This differences will be detailed below.  Overall, these algorithms' computational complexity is on the order of  O (NM), where N indicates the number of sequences in the input and M is the number of representative sequences. Therefore, their resources consumption is quite hard to predict since the data redundancy may be unknown until the algorithm is run. [^Cai]", 
            "title": "Greedy Heuristic Clustering"
        }, 
        {
            "location": "/matandmet/cluster/#cd-hit-and-cd-hit-est", 
            "text": "Originally developed to protein sequences clustering in 2001, this software was extended for nucleotides sequences in 2006. The algorithm supporting nucleotides clustering received the name CD-HIT-EST. CD-HIT package also includes many other binaries and perl scripts used to compare two databases, identify overlapping reads, etc. Since 2012, CD-HIT can run in multiple-thread, reducing the database size limitations.[^Li] CD-HIT's informations were retrieved from its  user's guide .   CD-HIT's algorithm starts by ordering the sequences from the longest to the shortest. The longest sequence is automatically a representative sequence. Then, as explained before, every other sequence will be classified as redundant or representative according to the sequences already classified as representative. The user can choose if redundant sequences should go to the first matching cluster (fast mode) or to the closest cluster after comparison with all representative sequences (accurate mode).  For speeding up its execution, CD-HIT uses a heuristic for reducing the amount of alignments. It consists in choosing which pairwise alignments are worth computing according to the common short words.  A short word or k-mer is a small sequence of k nucleotides (for DNAs) or amino acids (for proteins) from a bigger sequence. A linear sequence contains L-k+1 k-mers, where L is the sequence length. The combination and the repetition of those k-mers vary from sequence to sequence and that is the big advantage of using short word filters.  At first, an index table for the whole database must be built. Every unique k-mer has a unique index that indicates how many times this k-mer appears within each sequence. Then, thanks to previous studies on real alignments, we know statistically how many common k-mers two sequences must have so they share a particular identity. If the number of common k-mers is too low, than the algorithm can predict these sequences are not similar without performing the alignment.  This process means a significant gain in the algorithm's efficiency, since accessing information in a index table can be done quite fast. Besides, CD-HIT uses a k from 2 to 5 for proteins and a k from 8 to 12 for DNA, making sure all unique k-mers can be indexed in computer memory. For instance, there are, at most, 4 12  = 16M different k-mers with k=12. The suggested k value for each identity range is indicated in the user's manual.  However, as the quantity of common k-mers needed vary according to sequences length and alignment identities, the CD-HIT algorithm presents some limitations. With too long sequences or for too small identities thresholds, common k-mers counting are no longer good predictors. For this reason, CD-HIT suggests a identity minima between protein sequences at 40% and CD-HIT-EST suggests 75% for nucleotide sequences. For other cases (low identity or genome sized sequences), CD-HIT proposes the PSI-CD-HIT script.  PSI-CD-HIT is a perl script that can be used for both protein and nucleotide sequences. Its algorithm is similar to CD-HIT and CD-HIT-EST's, but it does not use the k-mers filters. Each sequence is compared to the representative sequences identified so far through BLAST (blastp, blastn or megablast). Thus, it is less efficient and it is only recommended for those particular cases where the classic programs are inadequate.   Another CD-HIT package limitation is that its output is influenced by the input sequences order.", 
            "title": "CD-HIT and CD-HIT-EST"
        }, 
        {
            "location": "/matandmet/cluster/#cd-hits-outputs", 
            "text": "CD-HIT's algorithms output two files. One is a fasta file containing all the dataset representative sequences. The other is a clstr file where each sequence cluster is described. A \" \" starts a cluster description and is followed by the cluster id. The following lines present sequences informations (id, length, header and identity). The \"*\" indicates the representative sequence, every other sequence inside a cluster is redundant with the representative.  The following clstr example was extracted from the user's manual:  Cluster 0\n0 2799aa,  PF04998.6|RPOC2_CHLRE/275-3073... * Cluster 1\n0 2214aa,  PF06317.1|Q6Y625_9VIRU/1-2214... at 80%\n1 2215aa,  PF06317.1|O09705_9VIRU/1-2215... at 84%\n2 2217aa,  PF06317.1|Q6Y630_9VIRU/1-2217... *\n3 2216aa,  PF06317.1|Q6GWS6_9VIRU/1-2216... at 84%\n4 527aa,  PF06317.1|Q67E14_9VIRU/6-532... at 63%", 
            "title": "CD-HIT's outputs"
        }, 
        {
            "location": "/matandmet/cluster/#uclust", 
            "text": "UCLUST's algorithm is part of the USEARCH package. Its binary files are available upon request in its  website . The 32-bit version is free, including for commercial uses. However, unlike the 64-bit paid version, it has a limitation of 4Gb RAM. User's manual is available in the  website .   In UCLUST, representative sequences are called centroids. They were once called seeds too, but this term is now obsolete. Centroids are in the center of the cluster which is represented by a circle of radius equal to the identity threshold. UCLUST can be used to both protein and nucleotide sequences. There are two clustering algorithms: cluster_fast and cluster_smallmem. Cluster_fast can sort the input sequences by decreasing length or decreasing abundance before clustering. Cluster_smallmem, contrarily, only processes the input in the order they are given.  The main difference from CD-HIT's algorithm is the sequences comparison. UCLUST uses the USEARCH algorithm. This algorithm also uses short word filters but in a slightly different way. The amount of k-mers shared between sequences guides the comparisons order. Centroids sequences are sorted by decreasing unique word count, that is, centroids that have more common unique k-mers are going to be aligned to the new sequence first. This means that the first time a pairwise alignment is found, it is likely to be the best alignment in the database. Plus, the more comparisons are done without finding a hit, the less likely it is that a hit exists in the database. This represents a big gain in efficiency, since it reduces the amount of alignements a sequence suites before realising it is not redundant.   identity calc  memory limitation", 
            "title": "UCLUST"
        }, 
        {
            "location": "/matandmet/cluster/#uclusts-outputs", 
            "text": "", 
            "title": "UCLUST's outputs"
        }, 
        {
            "location": "/matandmet/cluster/#vclust", 
            "text": "", 
            "title": "VCLUST"
        }, 
        {
            "location": "/matandmet/cluster/#viral-reference-database-case", 
            "text": "Show graphic from ESPRIT-Tree paper that shows time consumption + my predictions  Test cd-hit parallelizations  Explain that we care more about rapidity than accuracy  Talk about database size and length distribution    [^Cai]: Cai, Y.,   Sun, Y. (2011). ESPRIT-Tree: Hierarchical clustering analysis of millions of 16S rRNA pyrosequences in quasilinear computational time. Nucleic Acids Research, 39(14), 1\u201310. http://doi.org/10.1093/nar/gkr349  [^Kim]: Kim, M., Lee, K.-H., Yoon, S.-W., Kim, B.-S., Chun, J.,   Yi, H. (2013). Analytical Tools and Databases for Metagenomics in the Next-Generation Sequencing Era. Genomics   Informatics, 11(3), 102\u2013113.  [^Edgar]: Edgar, R. C. (2010). Search and clustering orders of magnitude faster than BLAST. Bioinformatics, 26(19), 2460\u20132461. http://doi.org/10.1093/bioinformatics/btq461  [^Fu]: Fu, L., Niu, B., Zhu, Z., Wu, S.,   Li, W. (2012). CD-HIT: Accelerated for clustering the next-generation sequencing data. Bioinformatics, 28(23), 3150\u20133152. http://doi.org/10.1093/bioinformatics/bts565  [^Quarst]: Quast, C., Pruesse, E., Yilmaz, P., Gerken, J., Schweer, T., Glo, F. O.,   Yarza, P. (2013). The SILVA ribosomal RNA gene database project : improved data processing and web-based tools. Nucleic Acids Research, 41(November 2012), 590\u2013596. http://doi.org/10.1093/nar/gks1219  [^Li]: Li, W., Fu, L., Niu, B., Wu, S.,   Wooley, J. (2015). CD-HIT User\u2019s Guide CD-HIT.", 
            "title": "Viral reference database case"
        }, 
        {
            "location": "/matandmet/workflow/", 
            "text": "Galaxy tools\n\n\nPlanemo", 
            "title": "Galaxy workflow"
        }, 
        {
            "location": "/matandmet/workflow/#galaxy-tools", 
            "text": "", 
            "title": "Galaxy tools"
        }, 
        {
            "location": "/matandmet/workflow/#planemo", 
            "text": "", 
            "title": "Planemo"
        }, 
        {
            "location": "/matandmet/shell_script/", 
            "text": "", 
            "title": "Shell script"
        }, 
        {
            "location": "/matandmet/test/", 
            "text": "", 
            "title": "Testing 'vir2'"
        }, 
        {
            "location": "/results/", 
            "text": "", 
            "title": "Results"
        }, 
        {
            "location": "/discussion/", 
            "text": "", 
            "title": "Discussion"
        }, 
        {
            "location": "/conclusion/", 
            "text": "", 
            "title": "Conclusion"
        }
    ]
}